<!-- Users Management -->
<div class="card mt-4" id="users-section" style="display:none;">
  <div class="card-header d-flex justify-content-between">
    <h3 class="card-title">Users Management</h3>
    <button id="addUserBtn" class="btn btn-primary">+ Add User</button>
  </div>
  <div class="card-body">
    <table class="table" id="usersTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Phone</th>
          <th>Role</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="usersTableBody"></tbody>
    </table>
  </div>
</div>

<script>
  // تحميل بيانات المستخدم من localStorage
const user = JSON.parse(localStorage.getItem("user")); 
  if (!user) {
    window.location.href = "index.html"; // رجوع للـ login لو ما في جلسة
  }

  // صلاحيات عرض الأقسام
  if (user.role === "super_admin") {
    document.getElementById("numbers-section").style.display = "block";
    document.getElementById("users-section").style.display = "block";
    loadSessionsByRole("super_admin", user.id);
  } else if (user.role === "admin") {
    document.getElementById("numbers-section").style.display = "block";
    loadSessionsByRole("admin", user.id);
  } else if (user.role === "supervisor") {
    // مؤقتاً مثل super_admin
   if (user.permissions?.can_manage_numbers) {
    document.getElementById("numbers-section").style.display = "block";
  }
  if (user.permissions?.can_manage_users) {
   document.getElementById("users-section").style.display = "block";
  } loadSessionsByRole("supervisor", user.id);
  } else if (user.role === "agent") {
    // Agent يشوف محادثاته فقط
    loadSessionsByRole("agent", user.id);
  }
 <!-- Modal لإدارة صلاحيات المشرف -->
<div class="modal fade" id="permModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Supervisor Permissions</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="permUsers">
          <label class="form-check-label">Can Manage Users</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="permNumbers">
          <label class="form-check-label">Can Manage Numbers</label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button class="btn btn-primary" onclick="savePermissions()">Save</button>
      </div>
    </div>
  </div>
</div> 
<!-- Add User Modal -->
<div class="modal fade" id="addUserModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add User</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Name</label>
          <input type="text" id="newName" class="form-control">
        </div>
        <div class="form-group">
          <label>Phone</label>
          <input type="text" id="newPhone" class="form-control">
        </div>
        <div class="form-group">
          <label>Role</label>
          <select id="newRole" class="form-control">
            <option value="super_admin">Super Admin</option>
            <option value="supervisor">Supervisor</option>
            <option value="admin">Admin</option>
            <option value="agent">Agent</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button class="btn btn-primary" onclick="createUser()">Save</button>
      </div>
    </div>
  </div>
</div>

<!-- Edit User Modal -->
<div class="modal fade" id="editUserModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit User</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Name</label>
          <input type="text" id="editName" class="form-control">
        </div>
        <div class="form-group">
          <label>Phone</label>
          <input type="text" id="editPhone" class="form-control">
        </div>
        <div class="form-group">
          <label>Role</label>
          <select id="editRole" class="form-control">
            <option value="super_admin">Super Admin</option>
            <option value="supervisor">Supervisor</option>
            <option value="admin">Admin</option>
            <option value="agent">Agent</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button class="btn btn-primary" onclick="saveUserEdits()">Save</button>
      </div>
    </div>
  </div>
</div>
 <!-- Controls -->
    <div class="row mb-3">
      <div class="col-md-6">
        <input type="text" id="search-users" class="form-control form-control-lg" placeholder="🔍 Search clients..." oninput="applyFilters()">
      </div>
      <div class="col-md-3">
        <select id="tagFilterUsers" class="form-control form-control-lg" onchange="applyFilters()">
          <option value="">All tags</option>
          <option value="VIP">VIP</option>
          <option value="New">New</option>
        </select>
      </div>
      <div class="col-md-3 text-right">
        <button id="logout-btn" class="btn btn-danger btn-lg"><i class="fas fa-sign-out-alt"></i> Logout</button>
      </div>
    </div>
 
